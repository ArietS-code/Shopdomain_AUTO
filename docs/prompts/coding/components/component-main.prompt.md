# component-main.prompt.md

## Objective
Generate all UI presentation components for the grocery ecommerce scaffold in one run (instead of invoking each individual component prompt). Ensures consistent prop definitions, event contracts, accessibility attributes, styling token usage, and colocated Jest + vue-test-utils spec files.

## Components Covered
1. Header (`Header.vue`) – navigation, logo alt text, cart subtotal badge consumption, search emit
2. Footer (`Footer.vue`) – semantic footer landmarks, minimal links
3. Product Card (`ProductCard.vue`) – price display, discount badge when `originalPrice` present, add-to-cart emit
4. Price Tag (`PriceTag.vue`) – handles price vs originalPrice, discount percentage (derived)
5. Deal Badge (`DealBadge.vue`) – visual tag for deals (e.g. "Deal", "New")
6. Cart Summary Badge (`CartSummaryBadge.vue`) – displays cart item count / subtotal from store getters
7. Category Grid (`CategoryGrid.vue`) – grid of categories with image + name
8. Promotion Banner (`PromotionBanner.vue`) – background image + headline/subheadline + optional CTA
9. Carousel (`Carousel.vue`) – auto-advancing hero slides with dot navigation (timers mocked in tests)
10. Search Bar (`SearchBar.vue`) – emits search text on submit; accessible form with role search

## File Generation
For each component:
- Source: `src/components/<ComponentName>.vue`
- Spec: `src/components/<ComponentName>.spec.ts`

## Implementation Conventions
- Vue 3 Options API (no `<script setup>` / Composition API)
- Props typed with `PropType<T>` for complex objects
- Event emissions declared via `emits: ['eventName']`
- Use global SCSS tokens (no magic values where token exists) – import via `@use` or rely on injected globals
- Accessibility: provide alt text for images, appropriate landmark semantics, aria-labels where specified
- Carousel uses `setInterval` (or `requestAnimationFrame`) with interval cleared on unmount
- No direct `import.meta.env`; consume env-dependent values through `EnvConsts` if needed (Header)

## Style & Tokens
- Tokens come from `src/theme/tokens.scss`
- Avoid inline styles if a token or utility class can express the value

## Testing Requirements (Each Spec)
Minimum tests in `<ComponentName>.spec.ts`:
1. Smoke render (component mounts without error)
2. Behavior: primary interaction (e.g. add-to-cart emit, search submit)
3. Accessibility: key aria attribute or alt text assertion
4. Edge case: optional prop absence or alternate path (e.g. ProductCard without `originalPrice` hides discount)
5. (Carousel only) Timer mocked; advancing to next slide works; dots clickable

Additional specifics:
- Header: asserts navigation links count, search emit, cart subtotal text presence (mock store)
- PriceTag: asserts discount percentage calculation when originalPrice present
- CartSummaryBadge: asserts count/subtotal formatting
- PromotionBanner: asserts CTA rendered only when props provided
- SearchBar: prevents empty submissions / trims value

## Derivation Utilities
If discount percentage needed, call `deriveDiscount(product)` from `src/interfaces/domain.ts` (should already exist). Avoid duplicating logic inside components.

## Store Interaction
Components needing cart data (Header, CartSummaryBadge) read via injected Vuex store getters (e.g. `cart/cartSubtotal`). Tests mock store using a minimal Vuex instance.

## Errors / Warnings
- Missing required props should produce Vue warning but not throw. Provide sensible defaults for optional styling props.
- Prefer graceful fallback (empty arrays render no items rather than error).

## Spec File Structure Template
```ts
import { mount } from '@vue/test-utils';
import ComponentName from './ComponentName.vue';

describe('ComponentName', () => {
  it('renders', () => { expect(mount(ComponentName).exists()).toBe(true); });
  // behavior
  // accessibility
  // edge case
});
```

## Post-Generation Validation
After running this prompt:
- All component `.vue` files created with matching `.spec.ts`
- `npm test` passes for new specs
- No unresolved imports (run `tsc --noEmit` if needed)
- No console a11y errors (manual check optional)

## Future Enhancements
- Add mobile navigation drawer logic in Header + expanded tests
- Integrate skeleton loaders for ProductCard grid
- Keyboard navigation for Carousel (left/right key handling)

Run this prompt via `/component-main`.

## Generation Parity Requirement
Each component generated by this aggregate prompt MUST be byte-for-byte identical to its corresponding example markdown file in `docs/prompts/coding/components/*example.md`. Enforcement steps:
1. Prior to generating a component, read its example file (e.g. `header.example.md`, `product-card.example.md`).
2. Emit the `<template>`, `<script>`, and `<style>` blocks exactly as shown (no added comments, no reformatted spacing, no reordered imports).
3. If a change is necessary, update the example file first in the same commit, then regenerate—never diverge silently.
4. After generation, run a diff check ensuring zero differences (excluding end-of-line normalization).
